"use strict";(()=>{let hitCount=0;const rows=10,cols=10,squareSize=50,winningHitCount=17,gameBoard=[],gameBoardContainer=document.getElementById("gameboard"),hitSound=new Audio("static/Hit Ship Sound.mp3"),missSound=new Audio("static/Miss Fire Sound.mp3"),sunkSound=new Audio("static/Ship Sunk Sound.mp3"),ships=[],searchngPhrases=["Thinking...","Hmm...","Finding...","Tracking...","Spotting...","Hunting...","Looking...","Scanning...","Seeking..."],firingPhrases=["Fire!","Launch!","Blast!","BOOM!","BANG!","There!","Attack!"],compSunkPhrases=["Aww Man!","SOS!","I'm Going Down!","Capsized!","I'm Sinking!","Cheater!","Shipwreck!","No Fair!","Hull Breach!","I won't lose!","Abandon Ship!","Overboard!","Stop it!","No Way!","Hey! Stop!","You wont win!","Lucky Shot!",":("],hoverColor=function(e){window.currentColor=e.target.style.backgroundColor,"rgb(128, 170, 255)"===e.target.style.backgroundColor&&(e.target.style.backgroundColor="#87CEFA")},resetHoverColor=function(e){e.target.style.backgroundColor=window.currentColor},innerModalControl=()=>{document.getElementById("thinking").style.display="flex",window.uiBlocker(2e3),window.sleep(1400).then(()=>{document.getElementById("message").innerText=firingPhrases[window.randomIntFromInterval(0,firingPhrases.length-1)]}),window.sleep(2e3).then(()=>{document.getElementById("thinking").style.display="none",window.sleep(300).then(()=>{window.compMoveWindow(),gameBoardContainer.addEventListener("click",fireTorpedo,!1)})}),document.getElementById("message").innerText=searchngPhrases[window.randomIntFromInterval(0,searchngPhrases.length-1)]},modalControl=shipSunkThisShot=>{if(gameBoardContainer.removeEventListener("click",fireTorpedo,!1),shipSunkThisShot){const delay=1500;window.modal(compSunkPhrases[window.randomIntFromInterval(0,compSunkPhrases.length-1)],delay),window.sleep(delay).then(()=>innerModalControl())}else innerModalControl()};function fireTorpedo(e){let shipSunkThisShot=!1;if(window.gameStarted&&!window.gameOver){if(e.target!==e.currentTarget){const row=e.target.id.substring(1,2),col=e.target.id.substring(2,3);if(0==gameBoard[row][col][0])e.target.style.backgroundColor="#4d88ff",gameBoard[row][col][0]=3,document.getElementById("s"+row+col).classList.add("miss"),window.currentColor="#4d88ff",missSound.play();else if(1==gameBoard[row][col][0]){e.target.style.backgroundColor="red",gameBoard[row][col][0]=2,document.getElementById("s"+row+col).classList.add("hit"),window.currentColor="red",hitSound.play(),hitCount++;let shipSunkCounter=0;for(const ship of ships)for(const coor of ship)if(coor[0]==row&&coor[1]==col)for(const coor of ship)if(2==gameBoard[coor[0]][coor[1]][0]&&shipSunkCounter++,shipSunkCounter==ship.length){window.currentColor="darkred";for(const coor of ship)document.getElementById("s"+coor[0]+coor[1]).style.backgroundColor="darkred";document.getElementById(gameBoard[coor[0]][coor[1]][1]+"Sunk").classList.add("sunkText"),shipSunkThisShot=!0,sunkSound.play()}if(17==hitCount){document.getElementById("wintext").style.display="block",gameBoardContainer.removeEventListener("click",fireTorpedo),window.gameOver=!0,window.modal("YOU WIN!!!",3e3);const valuetoPass=window.playerWinsOnLoad()+1;return window.setCookie("playerwinsBattleship",valuetoPass,.25),void(document.getElementById("playerWins").textContent="Player Wins: "+valuetoPass)}}else if(gameBoard[row][col][0]>1)return void window.modal("Can't Fire Here!",1400)}window.sleep(200).then(()=>modalControl(shipSunkThisShot)),e.stopPropagation()}}let nameIndex=0;const names=["Carrier","Battleship","Cruiser","Submarine","Destroyer"],usedCols=[1,2,4,6,8],usedRows=[2,4,6,7,9];function placeShip(len){const ship=[],name=names[nameIndex],dir=window.randomIntFromInterval(1,2);let row,col;do{row=window.randomIntFromInterval(0,9)}while(usedRows.includes(row));do{col=window.randomIntFromInterval(0,9)}while(usedCols.includes(col));let shipPlaceCounter=0;if(1==dir)if(col>=len-1){for(let i=0;i<len;i++)0==gameBoard[row][col-i][0]&&shipPlaceCounter++;if(shipPlaceCounter==len){for(let i=0;i<len;i++)gameBoard[row][col-i][0]=1,gameBoard[row][col-i][1]=name,ship.push([row,col-i]);usedRows.push(row),usedCols.push(col)}else placeShip(len)}else{for(let i=0;i<len;i++)0==gameBoard[row][col+i][0]&&shipPlaceCounter++;if(shipPlaceCounter==len){for(let i=0;i<len;i++)gameBoard[row][col+i][0]=1,gameBoard[row][col+i][1]=name,ship.push([row,col+i]);usedRows.push(row),usedCols.push(col)}else placeShip(len)}else if(row>=len-1){for(let i=0;i<len;i++)0==gameBoard[row-i][col][0]&&shipPlaceCounter++;if(shipPlaceCounter==len){for(let i=0;i<len;i++)gameBoard[row-i][col][0]=1,gameBoard[row-i][col][1]=name,ship.push([row-i,col]);usedRows.push(row),usedCols.push(col)}else placeShip(len)}else{for(let i=0;i<len;i++)0==gameBoard[row+i][col][0]&&shipPlaceCounter++;if(shipPlaceCounter==len){for(let i=0;i<len;i++)gameBoard[row+i][col][0]=1,gameBoard[row+i][col][1]=name,ship.push([row+i,col]);usedRows.push(row),usedCols.push(col)}else placeShip(len)}0!=ship.length&&(ships.push(ship),nameIndex++)}(()=>{gameBoardContainer.addEventListener("click",fireTorpedo,!1),document.getElementById("playerWins").textContent="Player Wins: "+window.playerWinsOnLoad();for(let i=0;i<10;i++){gameBoard.push([]);for(let j=0;j<10;j++){gameBoard[i].push([0,""]);const square=document.createElement("div");gameBoardContainer.appendChild(square),square.id="s"+j+i;const topPosition=50*j+5,leftPosition=50*i+5;square.style.top=topPosition+"px",square.style.left=leftPosition+"px",square.style.background="rgb(128, 170, 255)",square.addEventListener("mouseover",hoverColor),square.addEventListener("mouseleave",resetHoverColor)}}placeShip(5),placeShip(4),placeShip(3),placeShip(3),placeShip(2),window.exportedGameBoard=gameBoard,document.addEventListener("keydown",(function(event){if(192==event.keyCode){console.log(gameBoard);for(let i=0;i<10;i++)for(let j=0;j<10;j++)1==gameBoard[i][j][0]&&(document.getElementById("s"+i+j).style.background="white")}}))})()})();