"use strict";var exportedGameBoard,currentColor;(()=>{let hitCount=0;const rows=10,cols=10,squareSize=50,winningHitCount=17,gameBoard=[],gameBoardContainer=document.getElementById("gameboard"),strtOvrBtn=document.getElementById("strtOvrBtn"),hitSound=new Audio("static/Hit Ship Sound.mp3"),missSound=new Audio("static/Miss Fire Sound.mp3"),sunkSound=new Audio("static/Ship Sunk Sound.mp3"),ships=[],searchngPhrases=["Thinking...","Hmm...","Finding...","Tracking...","Spotting...","Hunting...","Looking...","Scanning..."],firingPhrases=["Fire!","Launch!","Blast!","BOOM!","BANG!","There!"],compSunkPhrases=["Aww Man!","SOS!","I'm Going Down!","Capsized!","I'm Sinking!","Cheater!","Shipwreck!","No Fair!","Awww!","Hull Breach!","I won't lose!","Abandon Ship!","Overboard!"],randomIntFromInterval=(min,max)=>Math.floor(Math.random()*(max-min+1)+min),hoverColor=function(e){currentColor=e.target.style.background,"rgb(128, 170, 255)"===e.target.style.background&&(e.target.style.background="#87CEFA")},resetHoverColor=function(e){e.target.style.background=currentColor},alertModalControl=(message,duration)=>{document.getElementById("alertshader").style.display="block",document.getElementById("alertmessage").innerText=message,sleep(duration).then(()=>{document.getElementById("alertshader").style.display="none"})},sleep=ms=>new Promise(resolve=>setTimeout(resolve,ms)),innerModalControl=()=>{document.getElementById("thinking").style.display="flex",document.getElementById("shader").style.display="block",sleep(1400).then(()=>{document.getElementById("message").innerText=firingPhrases[randomIntFromInterval(0,firingPhrases.length-1)]}),sleep(2e3).then(()=>{document.getElementById("thinking").style.display="none",document.getElementById("shader").style.display="none",sleep(300).then(()=>{window.compMoveWindow(),gameBoardContainer.addEventListener("click",fireTorpedo,!1)})}),document.getElementById("message").innerText=searchngPhrases[randomIntFromInterval(0,searchngPhrases.length-1)]},modalControl=shipSunkThisShot=>{if(gameBoardContainer.removeEventListener("click",fireTorpedo,!1),shipSunkThisShot){const delay=1500;alertModalControl(compSunkPhrases[randomIntFromInterval(0,compSunkPhrases.length-1)],delay),sleep(delay).then(()=>innerModalControl())}else innerModalControl()};function fireTorpedo(e){let shipSunkThisShot=!1;if(window.gameStarted&&!window.gameOver){if(e.target!==e.currentTarget){const row=e.target.id.substring(1,2),col=e.target.id.substring(2,3);if(0==gameBoard[row][col][0])e.target.style.background="#4d88ff",gameBoard[row][col][0]=3,document.getElementById("s"+row+col).classList.add("miss"),currentColor="#4d88ff",missSound.play();else if(1==gameBoard[row][col][0]){e.target.style.background="red",gameBoard[row][col][0]=2,document.getElementById("s"+row+col).classList.add("hit"),currentColor="red",hitSound.play(),hitCount++;let shipSunkCounter=0;for(const ship of ships)for(const coor of ship)if(coor[0]==row&&coor[1]==col)for(const coor of ship)if(2==gameBoard[coor[0]][coor[1]][0]&&shipSunkCounter++,shipSunkCounter==ship.length){currentColor="darkred";for(const coor of ship)document.getElementById("s"+coor[0]+coor[1]).style.background="darkred";document.getElementById(gameBoard[coor[0]][coor[1]][1]+"Sunk").classList.add("sunkText"),shipSunkThisShot=!0,sunkSound.play()}if(17==hitCount)return document.getElementById("wintext").style.display="block",gameBoardContainer.removeEventListener("click",fireTorpedo),window.gameOver=!0,void alertModalControl("YOU WIN!!!",3e3)}else if(gameBoard[row][col][0]>1)return void alertModalControl("Can't Fire Here!",1400)}sleep(200).then(()=>modalControl(shipSunkThisShot)),e.stopPropagation()}}let nameIndex=0;const names=["Carrier","Battleship","Cruiser","Submarine","Destroyer"];function placeShip(len){const ship=[],name=names[nameIndex],dir=randomIntFromInterval(1,2),row=randomIntFromInterval(0,9),col=randomIntFromInterval(0,9);let shipPlaceCounter=0;if(1==dir)if(col>=len-1){for(let i=0;i<len;i++)0==gameBoard[row][col-i][0]&&shipPlaceCounter++;if(shipPlaceCounter==len)for(let i=0;i<len;i++)gameBoard[row][col-i][0]=1,gameBoard[row][col-i][1]=name,ship.push([row,col-i]);else placeShip(len)}else{for(let i=0;i<len;i++)0==gameBoard[row][col+i][0]&&shipPlaceCounter++;if(shipPlaceCounter==len)for(let i=0;i<len;i++)gameBoard[row][col+i][0]=1,gameBoard[row][col+i][1]=name,ship.push([row,col+i]);else placeShip(len)}else if(row>=len-1){for(let i=0;i<len;i++)0==gameBoard[row-i][col][0]&&shipPlaceCounter++;if(shipPlaceCounter==len)for(let i=0;i<len;i++)gameBoard[row-i][col][0]=1,gameBoard[row-i][col][1]=name,ship.push([row-i,col]);else placeShip(len)}else{for(let i=0;i<len;i++)0==gameBoard[row+i][col][0]&&shipPlaceCounter++;if(shipPlaceCounter==len)for(let i=0;i<len;i++)gameBoard[row+i][col][0]=1,gameBoard[row+i][col][1]=name,ship.push([row+i,col]);else placeShip(len)}0!=ship.length&&(ships.push(ship),nameIndex++)}(()=>{gameBoardContainer.addEventListener("click",fireTorpedo,!1),strtOvrBtn.addEventListener("click",()=>location.reload());for(let i=0;i<10;i++){gameBoard.push([]);for(let j=0;j<10;j++){gameBoard[i].push([0,""]);const square=document.createElement("div");gameBoardContainer.appendChild(square),square.id="s"+j+i;const topPosition=50*j+5,leftPosition=50*i+5;square.style.top=topPosition+"px",square.style.left=leftPosition+"px",square.style.background="rgb(128, 170, 255)",square.addEventListener("mouseover",hoverColor),square.addEventListener("mouseleave",resetHoverColor)}}placeShip(5),placeShip(4),placeShip(3),placeShip(3),placeShip(2),exportedGameBoard=gameBoard,document.addEventListener("keydown",(function(event){if(192==event.keyCode){console.log(gameBoard);for(let i=0;i<10;i++)for(let j=0;j<10;j++)1==gameBoard[i][j][0]&&(document.getElementById("s"+i+j).style.background="white")}}))})()})();