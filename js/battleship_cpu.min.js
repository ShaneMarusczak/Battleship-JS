(()=>{function na(){if(I&&y){document.getElementById("downArrow").classList.add("notDisplayed");document.getElementById("leftList").classList.remove("notDisplayed");document.getElementById("ships").classList.add("notDisplayed");document.getElementById("startGame").classList.add("notDisplayed");document.getElementById("strtOvrBtn").classList.remove("notDisplayed");window.modal("Game on!",1500);window.gameStarted=!0;for(let b=0;10>b;b++)for(let a=0;10>a;a++){const c=document.getElementById("c"+b+a);
c.removeEventListener("mouseleave",fa);c.removeEventListener("click",U);c.removeEventListener("mouseover",V);c.removeEventListener("mouseleave",W);c.classList.remove("curserPointer")}}}let J,K,w,l,C="hor",X=0,L=0,n="",M=0,x=0,I=!1,Y=!1,Z=!1,aa=!1,ba=!1,ca=!1,y=!1,N=!1,O=!1,P=!1,Q=!1,R=!1;const h=[],oa=document.getElementById("gameboard_cpu"),pa=document.getElementById("carrier"),qa=document.getElementById("battleship"),ra=document.getElementById("cruiser"),sa=document.getElementById("submarine"),
ta=document.getElementById("destroyer"),ua=new Audio("sounds/Ship Sunk Sound.mp3"),S=[],va=[pa,qa,ra,sa,ta],m={battleship:4,carrier:5,cruiser:3,destroyer:2,submarine:3},ha="Found You!;You're Sunk!;Down she goes!;Gotcha!;Ha Ha!;I'm the best!;Woo Hoo!;I'm Better!;I'm gonna win!;Easy!;Sink that ship!;Try Harder!;Yawn...;Sunk!;Oh Yeah!;You're Gonna Lose!;Really? Easy..;Yes!!;So Easy!;Child's Play!;:)".split(";"),q=(b,a)=>0<=b&&10>b&&0<=a&&10>a,D=(b,a)=>{ua.play();document.getElementById(a+"Sunk_cpu").classList.remove("hitText");
document.getElementById(a+"Sunk_cpu").classList.add("sunkText");for(var c=0;10>c;c++)for(let f=0;10>f;f++)r(c,f,a)&&u(c,f)&&(window.addClassFromElementById("c"+c+f,"darkRedBackground"),window.removeClassFromElementById("c"+c+f,"redBackground"));L-=b;n="";for(b=0;10>b;b++)for(c=0;10>c;c++)r(b,c,a)&&(h[b][c][0]=4);0===window.randomIntFromInterval(0,10)?(b=window,c=b.modal,a=a.charAt(0).toUpperCase()+a.slice(1),c.call(b,a+" Sunk!",1500)):window.modal(ha[window.randomIntFromInterval(0,ha.length-1)],1500);
if(0<L)a:for(a=0;10>a;a++)for(b=0;10>b;b++)if(u(a,b)){J=a;K=b;break a}},ja=()=>{for(let b=0;10>b;b++)for(let a=0;10>a;a++)"hor"===C?(document.getElementById("c"+b+a).removeEventListener("mouseover",da),document.getElementById("c"+b+a).addEventListener("mouseover",ia)):(document.getElementById("c"+b+a).removeEventListener("mouseover",ia),document.getElementById("c"+b+a).addEventListener("mouseover",da));C="hor"===C?"ver":"hor"},ia=b=>{const a=b.target.id;let c=!0;for(let f=0;f<l;f++)if(!t(Number(a[1])+
f,Number(a[2]))){c=!1;break}if(Number(a[1])<11-l&&c)for(b.target.addEventListener("click",E),b=0;b<l;b++)document.getElementById(a[0]+(Number(a[1])+b)+a[2]).classList.add("blackBackground");else b.target.removeEventListener("click",E)},da=b=>{const a=b.target.id;let c=!0;for(let f=0;f<l;f++)if(!t(Number(a[1]),Number(a[2])+f)){c=!1;break}if(Number(a[2])<11-l&&c)for(b.target.addEventListener("click",E),b=0;b<l;b++)document.getElementById(a[0]+a[1]+(Number(a[2])+b)).classList.add("blackBackground");
else b.target.removeEventListener("click",E)},fa=()=>{for(let b=0;10>b;b++)for(let a=0;10>a;a++)t(b,a)&&(document.getElementById("c"+b+a).classList.remove("blackBackground"),document.getElementById("c"+b+a).classList.remove("greyBackground"))},U=b=>{if(0===l&&!window.gameStarted){let a;const c=Number(b.target.id[1]),f=Number(b.target.id[2]),[,e]=h[c][f];switch(e){case "carrier":Y=!1;break;case "battleship":Z=!1;break;case "cruiser":aa=!1;break;case "submarine":ba=!1;break;case "destroyer":ca=!1}l=
m[e];w=e;document.getElementById(e).classList.remove("hidden");ka.forEach(d=>document.getElementById(d).classList.remove("clicked"));document.getElementById(e).classList.add("clicked");x--;a:for(const d of S)for(const g of d)if(g[0]===c&&g[1]===f){C="hor"===h[g[0]][g[1]][2]?"ver":"hor";a=d;break a}a.forEach(d=>{const g=document.getElementById("c"+d[0]+d[1]);g.removeEventListener("mouseover",V);g.removeEventListener("mouseleave",W);g.removeEventListener("click",U);g.classList.remove("curserPointer");
h[d[0]][d[1]][0]=0;h[d[0]][d[1]][1]=""});S.splice(S.indexOf(a),1);wa();I=y=!1;document.getElementById("startGame").classList.contains("notDisplayed")||document.getElementById("startGame").classList.add("notDisplayed");ja()}b.stopImmediatePropagation()},ka=["carrier","battleship","cruiser","submarine","destroyer"],xa=b=>{if(!y){const a=b.target.parentElement.id;document.getElementById(a).classList.contains("clicked")?(document.getElementById(a).classList.remove("clicked"),l=0):(ka.forEach(c=>document.getElementById(c).classList.remove("clicked")),
"carrier"!==a||Y)?"battleship"!==a||Z?"cruiser"!==a||aa?"submarine"!==a||ba?"destroyer"!==a||ca||(l=m[a],b.target.parentElement.classList.add("clicked")):(l=m[a],b.target.parentElement.classList.add("clicked"),w="submarine"):(l=m[a],b.target.parentElement.classList.add("clicked"),w="cruiser"):(l=m[a],b.target.parentElement.classList.add("clicked")):(l=m[a],b.target.parentElement.classList.add("clicked"))}},V=b=>{if(0===l){[,b]=h[Number(b.target.id[1])][Number(b.target.id[2])];for(let a=0;10>a;a++)for(let c=
0;10>c;c++)r(a,c,b)&&(document.getElementById("c"+a+c).classList.remove("blackBackground"),document.getElementById("c"+a+c).classList.add("greyBackground"))}},W=b=>{[,b]=h[Number(b.target.id[1])][Number(b.target.id[2])];for(let a=0;10>a;a++)for(let c=0;10>c;c++)r(a,c,b)&&(document.getElementById("c"+a+c).classList.add("blackBackground"),document.getElementById("c"+a+c).classList.remove("greyBackground"))},wa=()=>{for(let b=0;10>b;b++)for(let a=0;10>a;a++)document.getElementById("c"+b+a).classList.contains("greyBackground")&&
(document.getElementById("c"+b+a).classList.add("blackBackground"),document.getElementById("c"+b+a).classList.remove("greyBackground"))},F=(b,a,c)=>{h[b][a][1]=c;h[b][a][2]=C},E=()=>{if(!I&&!y){const b=[];for(let a=0;10>a;a++)for(let c=0;10>c;c++)if(document.getElementById("c"+a+c).classList.contains("blackBackground")&&""===h[a][c][1]){l===m.carrier?F(a,c,"carrier"):l===m.battleship?F(a,c,"battleship"):l===m.cruiser&&"cruiser"===w?F(a,c,"cruiser"):l===m.submarine&&"submarine"===w?F(a,c,"submarine"):
l===m.destroyer&&F(a,c,"destroyer");const f=document.getElementById("c"+a+c);f.addEventListener("click",U);f.addEventListener("mouseover",V);f.addEventListener("mouseleave",W);f.removeEventListener("click",E);f.classList.add("curserPointer");h[a][c][0]=1;b.push([a,c])}l===m.carrier?(Y=!0,x++,document.getElementById("carrier").classList.add("hidden")):l===m.battleship?(Z=!0,x++,document.getElementById("battleship").classList.add("hidden")):l===m.cruiser?"cruiser"===w?(aa=!0,x++,document.getElementById("cruiser").classList.add("hidden")):
"submarine"===w&&(ba=!0,x++,document.getElementById("submarine").classList.add("hidden")):l===m.destroyer&&(ca=!0,x++,document.getElementById("destroyer").classList.add("hidden"));5===x&&(y=I=!0,document.getElementById("startGame").classList.remove("notDisplayed"),document.getElementById("instructions").innerHTML="<b>Placed ships can be moved before starting!</b>");l=0;S.push(b)}},r=(b,a,c)=>q(b,a)&&h[b][a][1]===c,za=()=>{if(N&&O&&P&&Q&&R){document.getElementById("losstext").style.display="block";
window.gameOver=!0;ya();window.sleep(1500).then(()=>window.modal("HA HA! I WIN!",2E3));const b=window.compWinsOnLoad()+1;window.setCookie("compwinsBattleship",b,.25);document.getElementById("compWins").textContent="Computer Wins: "+b}},Aa=b=>{let a=0;b.forEach(c=>{c>a&&(a=c)});return a},Ba=(b,a)=>{const c=Aa(la());let f={score:0,dir:"u"},e={score:0,dir:"d"},d={score:0,dir:"r"},g={score:0,dir:"l"};for(var k=1;k<c&&q(b-k,a)&&!p(b-k,a);k++)f.score++;for(k=1;k<c&&q(b+k,a)&&!p(b+k,a);k++)e.score++;for(k=
1;k<c&&q(b,a+k)&&!p(b,a+k);k++)d.score++;for(k=1;k<c&&q(b,a-k)&&!p(b,a-k);k++)g.score++;let ea=0,G=[];[f,e,g,d].forEach(H=>{ea===H.score?G.push(H):H.score>ea&&(ea=H.score,G=[],G.push(H))});return G[window.randomIntFromInterval(0,G.length-1)].dir},Ca=()=>{const b=J,a=K;if("d"===n){if(9>=b+1&&v(b+1,a,n,1))return;if(9<b+1||p(b+1,a)){for(var c=1;10>c&&!(0>b-c||3===h[b-c][a][0]||4===h[b-c][a][0]);c++){if(t(b-c,a)){z(b-c,a);return}if(A(b-c,a)){B(b-c,a);return}}n=""}}if("u"===n){if(0<=b-1&&v(b-1,a,n,-1))return;
if(0>b-1||p(b-1,a)){for(c=1;10>c&&!(9<b+c||3===h[b+c][a][0]||4===h[b+c][a][0]);c++){if(t(b+c,a)){z(b+c,a);return}if(A(b+c,a)){B(b+c,a);return}}n=""}}if("r"===n){if(9>=a+1&&v(b,a+1,n,1))return;if(9<a+1||p(b,a+1)){for(c=1;10>c&&!(0>a-c||3===h[b][a-c][0]||4===h[b][a-c][0]);c++){if(t(b,a-c)){z(b,a-c);return}if(A(b,a-c)){B(b,a-c);return}}n=""}}if("l"===n){if(0<=a-1&&v(b,a-1,n,-1))return;if(0>a-1||p(b,a-1)){for(c=1;10>c&&!(9<a+c||3===h[b][a+c][0]||4===h[b][a+c][0]);c++){if(t(b,a+c)){z(b,a+c);return}if(A(b,
a+c)){B(b,a+c);return}}n=""}}c=Ba(b,a);"u"===c?v(b-1,a,"u",-1):"d"===c?v(b+1,a,"d",1):"r"===c?v(b,a+1,"r",1):v(b,a-1,"l",-1)},v=(b,a,c,f)=>t(b,a)?(z(b,a),!0):A(b,a)?(B(b,a),n=c,"u"===c||"d"===c?J+=f:K+=f,!0):!1,t=(b,a)=>q(b,a)&&0===h[b][a][0],A=(b,a)=>q(b,a)&&1===h[b][a][0],u=(b,a)=>q(b,a)&&2===h[b][a][0],p=(b,a)=>q(b,a)&&1<h[b][a][0],B=(b,a)=>{document.getElementById("c"+b+a).classList.remove("blackBackground");document.getElementById("c"+b+a).classList.add("redBackground");h[b][a][0]=2;M=0;L++;
X++},z=(b,a)=>{document.getElementById("c"+b+a).classList.remove("blackBackground");document.getElementById("c"+b+a).classList.add("missBackground");h[b][a][0]=3;M++;X++},ma=()=>{let b,a,c=0;if(4>X||3<M){do{b=window.randomIntFromInterval(0,9);a=window.randomIntFromInterval(0,9);if(10<c){[b,a]=T(!1);break}c++}while(0!==b%2&&0===a%2||0===b%2&&0!==a%2||[2,3,4,5,7].includes(b)||[2,4,5,6,7].includes(a));0<M?1:0}else[b,a]=T(!1);J=b;K=a;t(b,a)?z(b,a):A(b,a)?B(b,a):p(b,a)&&ma()},Da=()=>{if(!window.gameOver&&
window.gameStarted)if(y){0<L?Ca():ma();T(!0);for(var b=0;10>b;b++)for(var a=0;10>a;a++)u(b,a)&&document.getElementById(h[b][a][1]+"Sunk_cpu").classList.add("hitText");var c=a=b=0,f=0,e=0;for(let d=0;10>d;d++)for(let g=0;10>g;g++)!N&&r(d,g,"carrier")&&u(d,g)?b++:!O&&r(d,g,"battleship")&&u(d,g)?a++:!P&&r(d,g,"cruiser")&&u(d,g)?c++:!Q&&r(d,g,"submarine")&&u(d,g)?f++:!R&&r(d,g,"destroyer")&&u(d,g)&&e++;b===m.carrier&&(N=!0,D(5,"carrier"));a===m.battleship&&(O=!0,D(4,"battleship"));c===m.cruiser&&(P=!0,
D(3,"cruiser"));f===m.submarine&&(Q=!0,D(3,"submarine"));e===m.destroyer&&(R=!0,D(2,"destroyer"));za()}else window.modal("Place all ships!",1400)},la=()=>{const b=[];N||b.push(m.carrier);O||b.push(m.battleship);Q||b.push(m.submarine);P||b.push(m.cruiser);R||b.push(m.destroyer);return b},T=b=>{var a=la(),c=!b;const f=[];for(var e=0;10>e;e++){f.push([]);for(var d=0;10>d;d++)c?f[e].push(0===window.randomIntFromInterval(0,2)?0:window.randomIntFromInterval(0,9)):f[e].push(0)}e=0;for(c=0;c<a.length;c++){for(d=
0;10>d;d++)for(var g=0;g<10-a[c]+1;g++){for(var k=0;k<a[c];k++)p(d,g+k)||e++;if(e===a[c])for(e=0;e<a[c];e++)f[d][g+e]++;e=0}for(d=0;10>d;d++)for(g=0;g<10-a[c]+1;g++){for(k=0;k<a[c];k++)p(g+k,d)||e++;if(e===a[c])for(e=0;e<a[c];e++)f[g+e][d]++;e=0}}c=0;a=[];for(e=0;10>e;e++)for(d=0;10>d;d++)f[e][d]===c?a.push([e,d]):f[e][d]>c&&(c=f[e][d],a=[],a.push([e,d]));if(b&&document.getElementById("visualize").checked)for(b=c,c=0;10>c;c++)for(e=0;10>e;e++)p(c,e)||(d=f[c][e],document.getElementById("c"+c+e).style.backgroundColor=
"rgba(128, 170, 255,"+Math.min(1,d/b+.25)+")");return a[window.randomIntFromInterval(0,a.length-1)]},ya=()=>{for(let b=0;10>b;b++)for(let a=0;10>a;a++)1===window.exportedGameBoard[b][a][0]&&window.addClassFromElementById("s"+b+a,"blackBackground")},Ea=()=>{window.addClassFromElementById("rotateArrow","rotateAnimation");window.removeClassFromElementById("rotateArrow","rotateBackAnimation")},Fa=()=>{window.removeClassFromElementById("rotateArrow","rotateAnimation");window.addClassFromElementById("rotateArrow",
"rotateBackAnimation")};(()=>{window.compMoveWindow=Da;for(let b=0;10>b;b++){h.push([]);for(let a=0;10>a;a++){h[b].push([0,""]);const c=document.createElement("div");oa.appendChild(c);c.id="c"+a+b;const f=50*b+5;c.style.top=50*a+5+"px";c.style.left=f+"px";c.style.backgroundColor="#80aaff";c.addEventListener("mouseover",da);c.addEventListener("mouseleave",fa)}}va.forEach(b=>b.addEventListener("click",xa));window.addEventListenerById("rotate","mouseover",Ea);window.addEventListenerById("rotate","mouseleave",
Fa);window.addEventListenerById("rotate","click",ja);window.addEventListenerById("startGame","click",na);document.getElementById("compWins").textContent="Computer Wins: "+window.compWinsOnLoad();document.addEventListener("keydown",function(b){"`"===b.key&&(console.log(h),T(!0))});"Y"===window.getCookie("darkMode")?window.setDarkMode():window.removeDarkMode()})()})();
