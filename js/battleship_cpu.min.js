(()=>{function oa(){if(J&&A){document.getElementById("downArrow").classList.add("notDisplayed");document.getElementById("leftList").classList.remove("notDisplayed");document.getElementById("ships").classList.add("notDisplayed");document.getElementById("startGame").classList.add("notDisplayed");document.getElementById("strtOvrBtn").classList.remove("notDisplayed");window.modal("Game on!",1500);window.gameStarted=!0;for(let a=0;10>a;a++)for(let b=0;10>b;b++){const c=document.getElementById("c"+a+b);
c.removeEventListener("mouseleave",fa);c.removeEventListener("click",U);c.removeEventListener("mouseover",V);c.removeEventListener("mouseleave",W);c.classList.remove("curserPointer")}}}let B,C,v,k,D="hor",X=0,K=0,p="",L=0,w=0,J=!1,Y=!1,Z=!1,aa=!1,ba=!1,ca=!1,A=!1,M=!1,N=!1,O=!1,P=!1,Q=!1;const h=[],pa=document.getElementById("gameboard_cpu"),qa=document.getElementById("carrier"),ra=document.getElementById("battleship"),sa=document.getElementById("cruiser"),ta=document.getElementById("submarine"),
ua=document.getElementById("destroyer"),va=new Audio("sounds/Ship Sunk Sound.mp3"),R=[],wa=[qa,ra,sa,ta,ua],l={battleship:4,carrier:5,cruiser:3,destroyer:2,submarine:3},ha="Found You!;You're Sunk!;Down she goes!;Gotcha!;Ha Ha!;I'm the best!;Woo Hoo!;I'm Better!;I'm gonna win!;Easy!;Sink that ship!;Try Harder!;Yawn...;Sunk!;Oh Yeah!;You're Gonna Lose!;Really? Easy..;Yes!!;So Easy!;Child's Play!;:)".split(";"),r=(a,b)=>0<=a&&10>a&&0<=b&&10>b,E=(a,b)=>{va.play();document.getElementById(b+"Sunk_cpu").classList.remove("hitText");
document.getElementById(b+"Sunk_cpu").classList.add("sunkText");for(var c=0;10>c;c++)for(let d=0;10>d;d++)t(c,d,b)&&u(c,d)&&(window.addClassFromElementById("c"+c+d,"darkRedBackground"),window.removeClassFromElementById("c"+c+d,"redBackground"));K-=a;p="";for(a=0;10>a;a++)for(c=0;10>c;c++)t(a,c,b)&&(h[a][c][0]=4);0===window.randomIntFromInterval(0,10)?(a=window,c=a.modal,b=b.charAt(0).toUpperCase()+b.slice(1),c.call(a,b+" Sunk!",1500)):window.modal(ha[window.randomIntFromInterval(0,ha.length-1)],1500);
if(0<K)a:for(b=0;10>b;b++)for(a=0;10>a;a++)if(u(b,a)){B=b;C=a;break a}},ja=()=>{for(let a=0;10>a;a++)for(let b=0;10>b;b++)"hor"===D?(document.getElementById("c"+a+b).removeEventListener("mouseover",da),document.getElementById("c"+a+b).addEventListener("mouseover",ia)):(document.getElementById("c"+a+b).removeEventListener("mouseover",ia),document.getElementById("c"+a+b).addEventListener("mouseover",da));D="hor"===D?"ver":"hor"},ia=a=>{const b=a.target.id;let c=!0;for(let d=0;d<k;d++)if(!q(Number(b[1])+
d,Number(b[2]))){c=!1;break}if(Number(b[1])<11-k&&c)for(a.target.addEventListener("click",F),a=0;a<k;a++)document.getElementById(b[0]+(Number(b[1])+a)+b[2]).classList.add("blackBackground");else a.target.removeEventListener("click",F)},da=a=>{const b=a.target.id;let c=!0;for(let d=0;d<k;d++)if(!q(Number(b[1]),Number(b[2])+d)){c=!1;break}if(Number(b[2])<11-k&&c)for(a.target.addEventListener("click",F),a=0;a<k;a++)document.getElementById(b[0]+b[1]+(Number(b[2])+a)).classList.add("blackBackground");
else a.target.removeEventListener("click",F)},fa=()=>{for(let a=0;10>a;a++)for(let b=0;10>b;b++)q(a,b)&&(document.getElementById("c"+a+b).classList.remove("blackBackground"),document.getElementById("c"+a+b).classList.remove("greyBackground"))},U=a=>{if(0===k&&!window.gameStarted){let b;const c=Number(a.target.id[1]),d=Number(a.target.id[2]),[,f]=h[c][d];switch(f){case "carrier":Y=!1;break;case "battleship":Z=!1;break;case "cruiser":aa=!1;break;case "submarine":ba=!1;break;case "destroyer":ca=!1}k=
l[f];v=f;document.getElementById(f).classList.remove("hidden");ka.forEach(e=>document.getElementById(e).classList.remove("clicked"));document.getElementById(f).classList.add("clicked");w--;for(const e of R)for(const g of e)if(g[0]===c&&g[1]===d){D="hor"===h[g[0]][g[1]][2]?"ver":"hor";b=e;break}b.forEach(e=>{const g=document.getElementById("c"+e[0]+e[1]);g.removeEventListener("mouseover",V);g.removeEventListener("mouseleave",W);g.removeEventListener("click",U);g.classList.remove("curserPointer");h[e[0]][e[1]][0]=
0;h[e[0]][e[1]][1]=""});R.splice(R.indexOf(b),1);xa();J=A=!1;document.getElementById("startGame").classList.contains("notDisplayed")||document.getElementById("startGame").classList.add("notDisplayed");ja()}a.stopImmediatePropagation()},ka=["carrier","battleship","cruiser","submarine","destroyer"],ya=a=>{if(!A){const b=a.target.parentElement.id;document.getElementById(b).classList.contains("clicked")?(document.getElementById(b).classList.remove("clicked"),k=0):(ka.forEach(c=>document.getElementById(c).classList.remove("clicked")),
"carrier"!==b||Y)?"battleship"!==b||Z?"cruiser"!==b||aa?"submarine"!==b||ba?"destroyer"!==b||ca||(k=l[b],a.target.parentElement.classList.add("clicked")):(k=l[b],a.target.parentElement.classList.add("clicked"),v="submarine"):(k=l[b],a.target.parentElement.classList.add("clicked"),v="cruiser"):(k=l[b],a.target.parentElement.classList.add("clicked")):(k=l[b],a.target.parentElement.classList.add("clicked"))}},V=a=>{if(0===k){[,a]=h[Number(a.target.id[1])][Number(a.target.id[2])];for(let b=0;10>b;b++)for(let c=
0;10>c;c++)t(b,c,a)&&(document.getElementById("c"+b+c).classList.remove("blackBackground"),document.getElementById("c"+b+c).classList.add("greyBackground"))}},W=a=>{[,a]=h[Number(a.target.id[1])][Number(a.target.id[2])];for(let b=0;10>b;b++)for(let c=0;10>c;c++)t(b,c,a)&&(document.getElementById("c"+b+c).classList.add("blackBackground"),document.getElementById("c"+b+c).classList.remove("greyBackground"))},xa=()=>{for(let a=0;10>a;a++)for(let b=0;10>b;b++)document.getElementById("c"+a+b).classList.contains("greyBackground")&&
(document.getElementById("c"+a+b).classList.add("blackBackground"),document.getElementById("c"+a+b).classList.remove("greyBackground"))},G=(a,b,c)=>{h[a][b][1]=c;h[a][b][2]=D},F=()=>{if(!J&&!A){const a=[];for(let b=0;10>b;b++)for(let c=0;10>c;c++)if(document.getElementById("c"+b+c).classList.contains("blackBackground")&&""===h[b][c][1]){k===l.carrier?G(b,c,"carrier"):k===l.battleship?G(b,c,"battleship"):k===l.cruiser&&"cruiser"===v?G(b,c,"cruiser"):k===l.submarine&&"submarine"===v?G(b,c,"submarine"):
k===l.destroyer&&G(b,c,"destroyer");const d=document.getElementById("c"+b+c);d.addEventListener("click",U);d.addEventListener("mouseover",V);d.addEventListener("mouseleave",W);d.removeEventListener("click",F);d.classList.add("curserPointer");h[b][c][0]=1;a.push([b,c])}k===l.carrier?(Y=!0,w++,document.getElementById("carrier").classList.add("hidden")):k===l.battleship?(Z=!0,w++,document.getElementById("battleship").classList.add("hidden")):k===l.cruiser?"cruiser"===v?(aa=!0,w++,document.getElementById("cruiser").classList.add("hidden")):
"submarine"===v&&(ba=!0,w++,document.getElementById("submarine").classList.add("hidden")):k===l.destroyer&&(ca=!0,w++,document.getElementById("destroyer").classList.add("hidden"));5===w&&(A=J=!0,document.getElementById("startGame").classList.remove("notDisplayed"),document.getElementById("instructions").innerHTML="<b>Placed ships can be moved before starting!</b>");k=0;R.push(a)}},t=(a,b,c)=>r(a,b)&&h[a][b][1]===c,Aa=()=>{if(M&&N&&O&&P&&Q){document.getElementById("losstext").style.display="block";
window.gameOver=!0;za();window.sleep(1500).then(()=>window.modal("HA HA! I WIN!",2E3));const a=window.compWinsOnLoad()+1;window.setCookie("compwinsBattleship",a,.25);document.getElementById("compWins").textContent="Computer Wins: "+a}},Ba=a=>{let b=0;a.forEach(c=>{c>b&&(b=c)});return b},Ca=(a,b)=>{const c=Ba(la());let d={score:0,dir:"u"},f={score:0,dir:"d"},e={score:0,dir:"r"},g={score:0,dir:"l"};for(var m=1;m<c&&r(a-m,b)&&!n(a-m,b);m++)d.score++;for(m=1;m<c&&r(a+m,b)&&!n(a+m,b);m++)f.score++;for(m=
1;m<c&&r(a,b+m)&&!n(a,b+m);m++)e.score++;for(m=1;m<c&&r(a,b-m)&&!n(a,b-m);m++)g.score++;let ea=0,H=[];[d,f,g,e].forEach(I=>{ea===I.score?H.push(I):I.score>ea&&(ea=I.score,H=[],H.push(I))});return H[window.randomIntFromInterval(0,H.length-1)].dir},Da=()=>{const a=B,b=C;if("d"===p){if(9>=a+1&&S(a+1,b,!0,1))return;if(9<a+1||n(a+1,b)){for(var c=1;10>c&&!(0>a-c||3===h[a-c][b][0]||4===h[a-c][b][0]);c++){if(q(a-c,b)){x(a-c,b);return}if(y(a-c,b)){z(a-c,b);return}}p=""}}if("u"===p){if(0<=a-1&&S(a-1,b,!0,-1))return;
if(0>a-1||n(a-1,b)){for(c=1;10>c&&!(9<a+c||3===h[a+c][b][0]||4===h[a+c][b][0]);c++){if(q(a+c,b)){x(a+c,b);return}if(y(a+c,b)){z(a+c,b);return}}p=""}}if("r"===p){if(9>=b+1&&S(a,b+1,!1,1))return;if(9<b+1||n(a,b+1)){for(c=1;10>c&&!(0>b-c||3===h[a][b-c][0]||4===h[a][b-c][0]);c++){if(q(a,b-c)){x(a,b-c);return}if(y(a,b-c)){z(a,b-c);return}}p=""}}if("l"===p){if(0<=b-1&&S(a,b-1,!1,-1))return;if(0>b-1||n(a,b-1)){for(c=1;10>c&&!(9<b+c||3===h[a][b+c][0]||4===h[a][b+c][0]);c++){if(q(a,b+c)){x(a,b+c);return}if(y(a,
b+c)){z(a,b+c);return}}p=""}}c=Ca(a,b);"u"===c?T(a-1,b,"u",-1):"d"===c?T(a+1,b,"d",1):"r"===c?T(a,b+1,"r",1):T(a,b-1,"l",-1)},S=(a,b,c,d)=>q(a,b)?(x(a,b),!0):y(a,b)?(z(a,b),c?B+=d:C+=d,!0):!1,T=(a,b,c,d)=>q(a,b)?(x(a,b),!0):y(a,b)?(z(a,b),p=c,"u"===c||"d"===c?B+=d:C+=d,!0):!1,q=(a,b)=>r(a,b)&&0===h[a][b][0],y=(a,b)=>r(a,b)&&1===h[a][b][0],u=(a,b)=>r(a,b)&&2===h[a][b][0],n=(a,b)=>r(a,b)&&1<h[a][b][0],z=(a,b)=>{document.getElementById("c"+a+b).classList.remove("blackBackground");document.getElementById("c"+
a+b).classList.add("redBackground");h[a][b][0]=2;L=0;K++;X++},x=(a,b)=>{document.getElementById("c"+a+b).classList.remove("blackBackground");document.getElementById("c"+a+b).classList.add("missBackground");h[a][b][0]=3;L++;X++},na=()=>{let a,b;if(4>X||4<L){do a=window.randomIntFromInterval(0,9),b=window.randomIntFromInterval(0,9);while(0!==a%2&&0===b%2||0===a%2&&0!==b%2||[2,3,4,5,7].includes(a)||[2,4,5,6,7].includes(b));L=3}else[a,b]=ma();B=a;C=b;q(a,b)?x(a,b):y(a,b)?z(a,b):n(a,b)&&na()},Ea=()=>{if(!window.gameOver&&
window.gameStarted)if(A){0<K?Da():na();ma();for(var a=0;10>a;a++)for(var b=0;10>b;b++)u(a,b)&&document.getElementById(h[a][b][1]+"Sunk_cpu").classList.add("hitText");var c=b=a=0,d=0,f=0;for(let e=0;10>e;e++)for(let g=0;10>g;g++)!M&&t(e,g,"carrier")&&u(e,g)?a++:!N&&t(e,g,"battleship")&&u(e,g)?b++:!O&&t(e,g,"cruiser")&&u(e,g)?c++:!P&&t(e,g,"submarine")&&u(e,g)?d++:!Q&&t(e,g,"destroyer")&&u(e,g)&&f++;a===l.carrier&&(M=!0,E(5,"carrier"));b===l.battleship&&(N=!0,E(4,"battleship"));c===l.cruiser&&(O=!0,
E(3,"cruiser"));d===l.submarine&&(P=!0,E(3,"submarine"));f===l.destroyer&&(Q=!0,E(2,"destroyer"));Aa()}else window.modal("Place all ships!",1400)},la=()=>{const a=[];M||a.push(l.carrier);N||a.push(l.battleship);P||a.push(l.submarine);O||a.push(l.cruiser);Q||a.push(l.destroyer);return a},ma=()=>{var a=la();const b=[];for(var c=0;10>c;c++){b.push([]);for(var d=0;10>d;d++)b[c].push(0)}d=0;for(c=0;c<a.length;c++){for(var f=0;10>f;f++)for(var e=0;e<10-a[c]+1;e++){for(var g=0;g<a[c];g++)n(f,e+g)||d++;if(d===
a[c])for(d=0;d<a[c];d++)b[f][e+d]++;d=0}for(f=0;10>f;f++)for(e=0;e<10-a[c]+1;e++){for(g=0;g<a[c];g++)n(e+g,f)||d++;if(d===a[c])for(d=0;d<a[c];d++)b[e+d][f]++;d=0}}c=0;a=[];for(d=0;10>d;d++)for(f=0;10>f;f++)b[d][f]===c?a.push([d,f]):b[d][f]>c&&(c=b[d][f],a=[],a.push([d,f]));for(d=0;10>d;d++)for(f=0;10>f;f++)n(d,f)||(e=b[d][f],document.getElementById("c"+d+f).style.backgroundColor="rgba(128, 170, 255,"+Math.min(1,e/c+.25)+")");return a[window.randomIntFromInterval(0,a.length-1)]},za=()=>{for(let a=
0;10>a;a++)for(let b=0;10>b;b++)1===window.exportedGameBoard[a][b][0]&&window.addClassFromElementById("s"+a+b,"blackBackground")},Fa=()=>{window.addClassFromElementById("rotateArrow","rotateAnimation");window.removeClassFromElementById("rotateArrow","rotateBackAnimation")},Ga=()=>{window.removeClassFromElementById("rotateArrow","rotateAnimation");window.addClassFromElementById("rotateArrow","rotateBackAnimation")};(()=>{window.compMoveWindow=Ea;for(let a=0;10>a;a++){h.push([]);for(let b=0;10>b;b++){h[a].push([0,
""]);const c=document.createElement("div");pa.appendChild(c);c.id="c"+b+a;const d=50*a+5;c.style.top=50*b+5+"px";c.style.left=d+"px";c.style.backgroundColor="#80aaff";c.addEventListener("mouseover",da);c.addEventListener("mouseleave",fa)}}wa.forEach(a=>a.addEventListener("click",ya));window.addEventListenerById("rotate","mouseover",Fa);window.addEventListenerById("rotate","mouseleave",Ga);window.addEventListenerById("rotate","click",ja);window.addEventListenerById("startGame","click",oa);document.getElementById("compWins").textContent=
"Computer Wins: "+window.compWinsOnLoad();document.addEventListener("keydown",function(a){192===a.keyCode&&console.log(h)});"Y"===window.getCookie("darkMode")?window.setDarkMode():window.removeDarkMode()})()})();
