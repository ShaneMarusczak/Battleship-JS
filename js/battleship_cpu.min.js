(()=>{function oa(){if(J&&A){document.getElementById("downArrow").classList.add("notDisplayed");document.getElementById("leftList").classList.remove("notDisplayed");document.getElementById("ships").classList.add("notDisplayed");document.getElementById("startGame").classList.add("notDisplayed");document.getElementById("strtOvrBtn").classList.remove("notDisplayed");window.modal("Game on!",1500);window.gameStarted=!0;for(let b=0;10>b;b++)for(let a=0;10>a;a++){const c=document.getElementById("c"+b+a);
c.removeEventListener("mouseleave",ha);c.removeEventListener("click",U);c.removeEventListener("mouseover",V);c.removeEventListener("mouseleave",W);c.classList.remove("curserPointer")}}}let B,C,v,l,D="hor",X=0,K=0,p="",L=0,w=0,J=!1,Y=!1,Z=!1,aa=!1,ba=!1,ca=!1,A=!1,M=!1,N=!1,O=!1,P=!1,Q=!1;const h=[],pa=document.getElementById("gameboard_cpu"),qa=document.getElementById("carrier"),ra=document.getElementById("battleship"),sa=document.getElementById("cruiser"),ta=document.getElementById("submarine"),
ua=document.getElementById("destroyer"),va=new Audio("sounds/Ship Sunk Sound.mp3"),R=[],wa=[qa,ra,sa,ta,ua],m={battleship:4,carrier:5,cruiser:3,destroyer:2,submarine:3},ia="Found You!;You're Sunk!;Down she goes!;Gotcha!;Ha Ha!;I'm the best!;Woo Hoo!;I'm Better!;I'm gonna win!;Easy!;Sink that ship!;Try Harder!;Yawn...;Sunk!;Oh Yeah!;You're Gonna Lose!;Really? Easy..;Yes!!;So Easy!;Child's Play!;:)".split(";"),r=(b,a)=>0<=b&&10>b&&0<=a&&10>a,E=(b,a)=>{va.play();document.getElementById(a+"Sunk_cpu").classList.remove("hitText");
document.getElementById(a+"Sunk_cpu").classList.add("sunkText");for(var c=0;10>c;c++)for(let e=0;10>e;e++)t(c,e,a)&&u(c,e)&&(window.addClassFromElementById("c"+c+e,"darkRedBackground"),window.removeClassFromElementById("c"+c+e,"redBackground"));K-=b;p="";for(b=0;10>b;b++)for(c=0;10>c;c++)t(b,c,a)&&(h[b][c][0]=4);0===window.randomIntFromInterval(0,10)?(b=window,c=b.modal,a=a.charAt(0).toUpperCase()+a.slice(1),c.call(b,a+" Sunk!",1500)):window.modal(ia[window.randomIntFromInterval(0,ia.length-1)],1500);
if(0<K)a:for(a=0;10>a;a++)for(b=0;10>b;b++)if(u(a,b)){B=a;C=b;break a}},ka=()=>{for(let b=0;10>b;b++)for(let a=0;10>a;a++)"hor"===D?(document.getElementById("c"+b+a).removeEventListener("mouseover",da),document.getElementById("c"+b+a).addEventListener("mouseover",ja)):(document.getElementById("c"+b+a).removeEventListener("mouseover",ja),document.getElementById("c"+b+a).addEventListener("mouseover",da));D="hor"===D?"ver":"hor"},ja=b=>{const a=b.target.id;let c=!0;for(let e=0;e<l;e++)if(!q(Number(a[1])+
e,Number(a[2]))){c=!1;break}if(Number(a[1])<11-l&&c)for(b.target.addEventListener("click",F),b=0;b<l;b++)document.getElementById(a[0]+(Number(a[1])+b)+a[2]).classList.add("blackBackground");else b.target.removeEventListener("click",F)},da=b=>{const a=b.target.id;let c=!0;for(let e=0;e<l;e++)if(!q(Number(a[1]),Number(a[2])+e)){c=!1;break}if(Number(a[2])<11-l&&c)for(b.target.addEventListener("click",F),b=0;b<l;b++)document.getElementById(a[0]+a[1]+(Number(a[2])+b)).classList.add("blackBackground");
else b.target.removeEventListener("click",F)},ha=()=>{for(let b=0;10>b;b++)for(let a=0;10>a;a++)q(b,a)&&(document.getElementById("c"+b+a).classList.remove("blackBackground"),document.getElementById("c"+b+a).classList.remove("greyBackground"))},U=b=>{if(0===l&&!window.gameStarted){let a;const c=Number(b.target.id[1]),e=Number(b.target.id[2]),[,f]=h[c][e];switch(f){case "carrier":Y=!1;break;case "battleship":Z=!1;break;case "cruiser":aa=!1;break;case "submarine":ba=!1;break;case "destroyer":ca=!1}l=
m[f];v=f;document.getElementById(f).classList.remove("hidden");la.forEach(d=>document.getElementById(d).classList.remove("clicked"));document.getElementById(f).classList.add("clicked");w--;a:for(const d of R)for(const g of d)if(g[0]===c&&g[1]===e){D="hor"===h[g[0]][g[1]][2]?"ver":"hor";a=d;break a}a.forEach(d=>{const g=document.getElementById("c"+d[0]+d[1]);g.removeEventListener("mouseover",V);g.removeEventListener("mouseleave",W);g.removeEventListener("click",U);g.classList.remove("curserPointer");
h[d[0]][d[1]][0]=0;h[d[0]][d[1]][1]=""});R.splice(R.indexOf(a),1);xa();J=A=!1;document.getElementById("startGame").classList.contains("notDisplayed")||document.getElementById("startGame").classList.add("notDisplayed");ka()}b.stopImmediatePropagation()},la=["carrier","battleship","cruiser","submarine","destroyer"],ya=b=>{if(!A){const a=b.target.parentElement.id;document.getElementById(a).classList.contains("clicked")?(document.getElementById(a).classList.remove("clicked"),l=0):(la.forEach(c=>document.getElementById(c).classList.remove("clicked")),
"carrier"!==a||Y)?"battleship"!==a||Z?"cruiser"!==a||aa?"submarine"!==a||ba?"destroyer"!==a||ca||(l=m[a],b.target.parentElement.classList.add("clicked")):(l=m[a],b.target.parentElement.classList.add("clicked"),v="submarine"):(l=m[a],b.target.parentElement.classList.add("clicked"),v="cruiser"):(l=m[a],b.target.parentElement.classList.add("clicked")):(l=m[a],b.target.parentElement.classList.add("clicked"))}},V=b=>{if(0===l){[,b]=h[Number(b.target.id[1])][Number(b.target.id[2])];for(let a=0;10>a;a++)for(let c=
0;10>c;c++)t(a,c,b)&&(document.getElementById("c"+a+c).classList.remove("blackBackground"),document.getElementById("c"+a+c).classList.add("greyBackground"))}},W=b=>{[,b]=h[Number(b.target.id[1])][Number(b.target.id[2])];for(let a=0;10>a;a++)for(let c=0;10>c;c++)t(a,c,b)&&(document.getElementById("c"+a+c).classList.add("blackBackground"),document.getElementById("c"+a+c).classList.remove("greyBackground"))},xa=()=>{for(let b=0;10>b;b++)for(let a=0;10>a;a++)document.getElementById("c"+b+a).classList.contains("greyBackground")&&
(document.getElementById("c"+b+a).classList.add("blackBackground"),document.getElementById("c"+b+a).classList.remove("greyBackground"))},G=(b,a,c)=>{h[b][a][1]=c;h[b][a][2]=D},F=()=>{if(!J&&!A){const b=[];for(let a=0;10>a;a++)for(let c=0;10>c;c++)if(document.getElementById("c"+a+c).classList.contains("blackBackground")&&""===h[a][c][1]){l===m.carrier?G(a,c,"carrier"):l===m.battleship?G(a,c,"battleship"):l===m.cruiser&&"cruiser"===v?G(a,c,"cruiser"):l===m.submarine&&"submarine"===v?G(a,c,"submarine"):
l===m.destroyer&&G(a,c,"destroyer");const e=document.getElementById("c"+a+c);e.addEventListener("click",U);e.addEventListener("mouseover",V);e.addEventListener("mouseleave",W);e.removeEventListener("click",F);e.classList.add("curserPointer");h[a][c][0]=1;b.push([a,c])}l===m.carrier?(Y=!0,w++,document.getElementById("carrier").classList.add("hidden")):l===m.battleship?(Z=!0,w++,document.getElementById("battleship").classList.add("hidden")):l===m.cruiser?"cruiser"===v?(aa=!0,w++,document.getElementById("cruiser").classList.add("hidden")):
"submarine"===v&&(ba=!0,w++,document.getElementById("submarine").classList.add("hidden")):l===m.destroyer&&(ca=!0,w++,document.getElementById("destroyer").classList.add("hidden"));5===w&&(A=J=!0,document.getElementById("startGame").classList.remove("notDisplayed"),document.getElementById("instructions").innerHTML="<b>Placed ships can be moved before starting!</b>");l=0;R.push(b)}},t=(b,a,c)=>r(b,a)&&h[b][a][1]===c,Aa=()=>{if(M&&N&&O&&P&&Q){document.getElementById("losstext").style.display="block";
window.gameOver=!0;za();window.sleep(1500).then(()=>window.modal("HA HA! I WIN!",2E3));const b=window.compWinsOnLoad()+1;window.setCookie("compwinsBattleship",b,.25);document.getElementById("compWins").textContent="Computer Wins: "+b}},Ba=b=>{let a=0;b.forEach(c=>{c>a&&(a=c)});return a},Ca=(b,a)=>{const c=Ba(ma());let e={score:0,dir:"u"},f={score:0,dir:"d"},d={score:0,dir:"r"},g={score:0,dir:"l"};for(var k=1;k<c&&r(b-k,a)&&!n(b-k,a);k++)e.score++;for(k=1;k<c&&r(b+k,a)&&!n(b+k,a);k++)f.score++;for(k=
1;k<c&&r(b,a+k)&&!n(b,a+k);k++)d.score++;for(k=1;k<c&&r(b,a-k)&&!n(b,a-k);k++)g.score++;let ea=0,H=[];[e,f,g,d].forEach(I=>{ea===I.score?H.push(I):I.score>ea&&(ea=I.score,H=[],H.push(I))});return H[window.randomIntFromInterval(0,H.length-1)].dir},Da=()=>{const b=B,a=C;if("d"===p){if(9>=b+1&&S(b+1,a,!0,1))return;if(9<b+1||n(b+1,a)){for(var c=1;10>c&&!(0>b-c||3===h[b-c][a][0]||4===h[b-c][a][0]);c++){if(q(b-c,a)){x(b-c,a);return}if(y(b-c,a)){z(b-c,a);return}}p=""}}if("u"===p){if(0<=b-1&&S(b-1,a,!0,-1))return;
if(0>b-1||n(b-1,a)){for(c=1;10>c&&!(9<b+c||3===h[b+c][a][0]||4===h[b+c][a][0]);c++){if(q(b+c,a)){x(b+c,a);return}if(y(b+c,a)){z(b+c,a);return}}p=""}}if("r"===p){if(9>=a+1&&S(b,a+1,!1,1))return;if(9<a+1||n(b,a+1)){for(c=1;10>c&&!(0>a-c||3===h[b][a-c][0]||4===h[b][a-c][0]);c++){if(q(b,a-c)){x(b,a-c);return}if(y(b,a-c)){z(b,a-c);return}}p=""}}if("l"===p){if(0<=a-1&&S(b,a-1,!1,-1))return;if(0>a-1||n(b,a-1)){for(c=1;10>c&&!(9<a+c||3===h[b][a+c][0]||4===h[b][a+c][0]);c++){if(q(b,a+c)){x(b,a+c);return}if(y(b,
a+c)){z(b,a+c);return}}p=""}}c=Ca(b,a);"u"===c?T(b-1,a,"u",-1):"d"===c?T(b+1,a,"d",1):"r"===c?T(b,a+1,"r",1):T(b,a-1,"l",-1)},S=(b,a,c,e)=>q(b,a)?(x(b,a),!0):y(b,a)?(z(b,a),c?B+=e:C+=e,!0):!1,T=(b,a,c,e)=>q(b,a)?(x(b,a),!0):y(b,a)?(z(b,a),p=c,"u"===c||"d"===c?B+=e:C+=e,!0):!1,q=(b,a)=>r(b,a)&&0===h[b][a][0],y=(b,a)=>r(b,a)&&1===h[b][a][0],u=(b,a)=>r(b,a)&&2===h[b][a][0],n=(b,a)=>r(b,a)&&1<h[b][a][0],z=(b,a)=>{document.getElementById("c"+b+a).classList.remove("blackBackground");document.getElementById("c"+
b+a).classList.add("redBackground");h[b][a][0]=2;L=0;K++;X++},x=(b,a)=>{document.getElementById("c"+b+a).classList.remove("blackBackground");document.getElementById("c"+b+a).classList.add("missBackground");h[b][a][0]=3;L++;X++},na=()=>{let b,a;if(4>X||4<L){do b=window.randomIntFromInterval(0,9),a=window.randomIntFromInterval(0,9);while(0!==b%2&&0===a%2||0===b%2&&0!==a%2||[2,3,4,5,7].includes(b)||[2,4,5,6,7].includes(a));L=3}else[b,a]=fa(!1);B=b;C=a;q(b,a)?x(b,a):y(b,a)?z(b,a):n(b,a)&&na()},Ea=()=>
{if(!window.gameOver&&window.gameStarted)if(A){0<K?Da():na();fa(!0);for(var b=0;10>b;b++)for(var a=0;10>a;a++)u(b,a)&&document.getElementById(h[b][a][1]+"Sunk_cpu").classList.add("hitText");var c=a=b=0,e=0,f=0;for(let d=0;10>d;d++)for(let g=0;10>g;g++)!M&&t(d,g,"carrier")&&u(d,g)?b++:!N&&t(d,g,"battleship")&&u(d,g)?a++:!O&&t(d,g,"cruiser")&&u(d,g)?c++:!P&&t(d,g,"submarine")&&u(d,g)?e++:!Q&&t(d,g,"destroyer")&&u(d,g)&&f++;b===m.carrier&&(M=!0,E(5,"carrier"));a===m.battleship&&(N=!0,E(4,"battleship"));
c===m.cruiser&&(O=!0,E(3,"cruiser"));e===m.submarine&&(P=!0,E(3,"submarine"));f===m.destroyer&&(Q=!0,E(2,"destroyer"));Aa()}else window.modal("Place all ships!",1400)},ma=()=>{const b=[];M||b.push(m.carrier);N||b.push(m.battleship);P||b.push(m.submarine);O||b.push(m.cruiser);Q||b.push(m.destroyer);return b},fa=b=>{var a=ma(),c=!b;const e=[];for(var f=0;10>f;f++){e.push([]);for(var d=0;10>d;d++)c?e[f].push(0===window.randomIntFromInterval(0,2)?0:window.randomIntFromInterval(0,9)):e[f].push(0)}f=0;
for(c=0;c<a.length;c++){for(d=0;10>d;d++)for(var g=0;g<10-a[c]+1;g++){for(var k=0;k<a[c];k++)n(d,g+k)||f++;if(f===a[c])for(f=0;f<a[c];f++)e[d][g+f]++;f=0}for(d=0;10>d;d++)for(g=0;g<10-a[c]+1;g++){for(k=0;k<a[c];k++)n(g+k,d)||f++;if(f===a[c])for(f=0;f<a[c];f++)e[g+f][d]++;f=0}}c=0;a=[];for(f=0;10>f;f++)for(d=0;10>d;d++)e[f][d]===c?a.push([f,d]):e[f][d]>c&&(c=e[f][d],a=[],a.push([f,d]));if(b&&document.getElementById("visualize").checked)for(b=c,c=0;10>c;c++)for(f=0;10>f;f++)n(c,f)||(d=e[c][f],document.getElementById("c"+
c+f).style.backgroundColor="rgba(128, 170, 255,"+Math.min(1,d/b+.25)+")");return a[window.randomIntFromInterval(0,a.length-1)]},za=()=>{for(let b=0;10>b;b++)for(let a=0;10>a;a++)1===window.exportedGameBoard[b][a][0]&&window.addClassFromElementById("s"+b+a,"blackBackground")},Fa=()=>{window.addClassFromElementById("rotateArrow","rotateAnimation");window.removeClassFromElementById("rotateArrow","rotateBackAnimation")},Ga=()=>{window.removeClassFromElementById("rotateArrow","rotateAnimation");window.addClassFromElementById("rotateArrow",
"rotateBackAnimation")};(()=>{window.compMoveWindow=Ea;for(let b=0;10>b;b++){h.push([]);for(let a=0;10>a;a++){h[b].push([0,""]);const c=document.createElement("div");pa.appendChild(c);c.id="c"+a+b;const e=50*b+5;c.style.top=50*a+5+"px";c.style.left=e+"px";c.style.backgroundColor="#80aaff";c.addEventListener("mouseover",da);c.addEventListener("mouseleave",ha)}}wa.forEach(b=>b.addEventListener("click",ya));window.addEventListenerById("rotate","mouseover",Fa);window.addEventListenerById("rotate","mouseleave",
Ga);window.addEventListenerById("rotate","click",ka);window.addEventListenerById("startGame","click",oa);document.getElementById("compWins").textContent="Computer Wins: "+window.compWinsOnLoad();document.addEventListener("keydown",function(b){"`"===b.key&&(console.log(h),fa(!0))});"Y"===window.getCookie("darkMode")?window.setDarkMode():window.removeDarkMode()})()})();
